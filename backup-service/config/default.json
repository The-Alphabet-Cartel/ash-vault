{
  "_metadata": {
    "file_version": "v5.0-3-3.5-1",
    "last_modified": "2026-01-09",
    "clean_architecture": "Compliant",
    "description": "Ash-Vault Backup Service Configuration",
    "repository": "https://github.com/the-alphabet-cartel/ash-vault",
    "community": "The Alphabet Cartel - https://discord.gg/alphabetcartel | https://alphabetcartel.org"
  },

  "server": {
    "description": "Health endpoint server configuration",
    "host": "${VAULT_HOST}",
    "port": "${VAULT_PORT}",
    "defaults": {
      "host": "0.0.0.0",
      "port": 30886
    },
    "validation": {
      "host": {
        "type": "string",
        "required": true
      },
      "port": {
        "type": "integer",
        "range": [1024, 65535],
        "required": true
      }
    }
  },

  "logging": {
    "description": "Logging configuration",
    "level": "${VAULT_LOG_LEVEL}",
    "defaults": {
      "level": "INFO"
    },
    "validation": {
      "level": {
        "type": "string",
        "allowed_values": ["DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"],
        "required": true
      }
    }
  },

  "zfs": {
    "description": "ZFS snapshot configuration",
    "pool": "${VAULT_ZFS_POOL}",
    "dataset": "${VAULT_ZFS_DATASET}",
    "defaults": {
      "pool": "syn",
      "dataset": "syn/archives"
    },
    "validation": {
      "pool": {
        "type": "string",
        "required": true
      },
      "dataset": {
        "type": "string",
        "required": true
      }
    }
  },

  "schedules": {
    "description": "Backup schedule configuration (cron format)",
    "snapshot_daily": "${VAULT_SCHEDULE_SNAPSHOT_DAILY}",
    "snapshot_weekly": "${VAULT_SCHEDULE_SNAPSHOT_WEEKLY}",
    "snapshot_monthly": "${VAULT_SCHEDULE_SNAPSHOT_MONTHLY}",
    "replication": "${VAULT_SCHEDULE_REPLICATION}",
    "cloud_sync": "${VAULT_SCHEDULE_CLOUD_SYNC}",
    "defaults": {
      "snapshot_daily": "0 3 * * *",
      "snapshot_weekly": "0 3 * * 0",
      "snapshot_monthly": "0 3 1 * *",
      "replication": "0 4 * * *",
      "cloud_sync": "0 5 * * 0"
    },
    "validation": {
      "snapshot_daily": {
        "type": "string",
        "required": true
      },
      "snapshot_weekly": {
        "type": "string",
        "required": true
      },
      "snapshot_monthly": {
        "type": "string",
        "required": true
      },
      "replication": {
        "type": "string",
        "required": true
      },
      "cloud_sync": {
        "type": "string",
        "required": true
      }
    }
  },

  "retention": {
    "description": "Snapshot retention policy",
    "daily_count": "${VAULT_RETENTION_DAILY}",
    "weekly_count": "${VAULT_RETENTION_WEEKLY}",
    "monthly_count": "${VAULT_RETENTION_MONTHLY}",
    "defaults": {
      "daily_count": 7,
      "weekly_count": 4,
      "monthly_count": 12
    },
    "validation": {
      "daily_count": {
        "type": "integer",
        "range": [1, 30],
        "required": true
      },
      "weekly_count": {
        "type": "integer",
        "range": [1, 12],
        "required": true
      },
      "monthly_count": {
        "type": "integer",
        "range": [1, 24],
        "required": true
      }
    }
  },

  "replication": {
    "description": "ZFS replication to Lofn configuration",
    "lofn_host": "${VAULT_LOFN_HOST}",
    "lofn_dataset": "${VAULT_LOFN_DATASET}",
    "ssh_key": "${VAULT_SSH_KEY}",
    "defaults": {
      "lofn_host": "10.20.30.253",
      "lofn_dataset": "backup/ash-vault",
      "ssh_key": "/root/.ssh/id_ed25519_lofn"
    },
    "validation": {
      "lofn_host": {
        "type": "string",
        "required": true
      },
      "lofn_dataset": {
        "type": "string",
        "required": true
      },
      "ssh_key": {
        "type": "string",
        "required": true
      }
    }
  },

  "cloud": {
    "description": "Backblaze B2 cloud backup configuration",
    "b2_bucket": "${VAULT_B2_BUCKET}",
    "minio_data_path": "${VAULT_MINIO_DATA}",
    "rclone_remote": "${VAULT_RCLONE_REMOTE}",
    "defaults": {
      "b2_bucket": "ash-vault-backup-alphabetcartel",
      "minio_data_path": "/mnt/archives/minio-data",
      "rclone_remote": "b2"
    },
    "validation": {
      "b2_bucket": {
        "type": "string",
        "required": true
      },
      "minio_data_path": {
        "type": "string",
        "required": true
      },
      "rclone_remote": {
        "type": "string",
        "required": true
      }
    }
  },

  "alerting": {
    "description": "Discord webhook alerting configuration",
    "enabled": "${VAULT_ALERTING_ENABLED}",
    "on_success": "${VAULT_ALERT_ON_SUCCESS}",
    "on_failure": "${VAULT_ALERT_ON_FAILURE}",
    "defaults": {
      "enabled": true,
      "on_success": false,
      "on_failure": true
    },
    "validation": {
      "enabled": {
        "type": "boolean",
        "required": false
      },
      "on_success": {
        "type": "boolean",
        "required": false
      },
      "on_failure": {
        "type": "boolean",
        "required": false
      }
    }
  }
}
